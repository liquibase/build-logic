# .trivyignore - Unified Trivy vulnerability scanner suppressions
#
# This file is the single source of truth for Trivy false positives and accepted risks.
# It is shared between docker and liquibase-pro repositories.
#
# Usage:
#   Repos should copy this file to their workspace before scanning:
#     cp build-logic/.trivyignore .trivyignore
#
# Maintained by: DevOps Team
# Repository: https://github.com/liquibase/build-logic

# ==============================================================================
# CVE-2025-59250 - Microsoft SQL Server JDBC Driver
# ==============================================================================
# Status: FALSE POSITIVE
#
# Description:
# Trivy flags mssql-jdbc 13.2.1 as vulnerable to CVE-2025-59250, but the
# installed JAR is actually 13.2.1.jre11 which CONTAINS THE FIX.
#
# Evidence:
# - Liquibase Secure 5.1.0 specifies mssql-jdbc 13.2.1.jre11 in pom.xml
# - The JAR in the Docker image is the patched 13.2.1.jre11 variant
# - Trivy reads the internal pom.properties which reports version "13.2.1"
#   (without the jre11 classifier), causing a false version comparison
#
# Root Cause of False Positive:
# Microsoft's non-standard Maven versioning uses a classifier suffix (jre11)
# instead of a standard version bump. The JAR's internal pom.properties reports
# version 13.2.1 without the classifier. Trivy compares 13.2.1 < 13.2.1.jre11
# and incorrectly flags it as vulnerable.
#
# References:
# - Liquibase Secure 5.1.0 pom.xml: <mssql.version>13.2.1.jre11</mssql.version>
# - Jira ticket: DAT-22288
# - Trivy Discussion: https://github.com/aquasecurity/trivy/discussions/9745
# - Grype Issue: https://github.com/anchore/grype/issues/3042
# - Microsoft JDBC Driver release notes:
#   https://learn.microsoft.com/en-us/sql/connect/jdbc/release-notes-for-the-jdbc-driver
#
# Date Added: 2025-11-20
# Updated: 2026-02-23 (extended expiration, updated to 13.2.1.jre11 / Secure 5.1.0)
# Added By: DevOps Team
# Review Date: 2026-08-20 (review when Trivy database is updated)
CVE-2025-59250 exp:2026-08-20

# ==============================================================================
# GraalVM Python/setuptools - FALSE POSITIVES
# ==============================================================================
# Status: FALSE POSITIVE
#
# Description:
# Trivy Deep Scan finds setuptools vulnerabilities in Python packages embedded
# within GraalVM extensions (org.graalvm.python.vfs). These are false positives.
#
# Technical Justification:
# GraalVM Python is used in liquibase-checks for custom validation scripts.
# While network access is enabled for the Python runtime, setuptools package
# management functions are NEVER invoked at runtime:
#
# - CVE-2022-40897 (ReDoS): Requires setuptools to parse HTML during package lookup.
#   No package lookups occur - all packages are pre-installed at build time via Maven.
#
# - CVE-2024-6345 (Command injection): Requires setuptools to process URLs.
#   setuptools download/install functions are never called at runtime.
#
# - CVE-2025-47273 (Path traversal): Requires setuptools to process package inputs.
#   No package installation or processing occurs at runtime.
#
# setuptools is bundled as a transitive dependency (standard Python tooling) but
# its package management functionality is never used. Package installation occurs
# only during Maven build via graalpy-maven-plugin, not at runtime.
#
# Source: Code review of liquibase-checks PythonScriptExecutor.java
# Date Added: 2025-12-04
# Added By: DevOps Team
# Review Date: 2026-06-10
CVE-2022-40897 exp:2026-06-10
CVE-2024-6345 exp:2026-06-10
CVE-2025-47273 exp:2026-06-10
